{% extends 'base.html' %}

{% block content %}
    <h1>Setup Two-Factor Authentication</h1>
    <p>Scan the QR code below with your authenticator app (like Google Authenticator, Authy, FreeOTP) or manually enter the secret key.</p>

    <div class="mb-3">
        <img src="data:image/png;base64,{{ qr_code }}" alt="QR Code for TOTP" class="img-thumbnail">
    </div>

    <p>Secret Key (for manual entry): <strong>{{ secret_key }}</strong></p>

    <p>
        After scanning the QR code or entering the secret key into your authenticator app, please enter the verification code generated by the app below to confirm setup.
    </p>

    <form method="post">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.totp_code.label(class="form-control-label") }}
            {{ form.totp_code(class="form-control") }}
            {% for error in form.totp_code.errors %}
                <small class="form-text text-danger">[{{ error }}]</small>
            {% endfor %}
        </div>
        <button type="submit" class="btn btn-primary">{{ form.submit.label }}</button>
    </form>

{% endblock %}